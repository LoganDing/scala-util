This code is mostly from [Twitter finagle](https://github.com/twitter/finagle/tree/master/finagle-core/src/main/scala/com/twitter/finagle/ssl) with a little adjustment for Netty 4 and our own stuff.
